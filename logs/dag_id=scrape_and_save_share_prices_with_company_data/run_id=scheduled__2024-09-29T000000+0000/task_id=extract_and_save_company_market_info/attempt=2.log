[2024-09-30T07:44:10.406+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-09-30T07:44:10.424+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: scrape_and_save_share_prices_with_company_data.extract_and_save_company_market_info scheduled__2024-09-29T00:00:00+00:00 [queued]>
[2024-09-30T07:44:10.433+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: scrape_and_save_share_prices_with_company_data.extract_and_save_company_market_info scheduled__2024-09-29T00:00:00+00:00 [queued]>
[2024-09-30T07:44:10.434+0000] {taskinstance.py:2865} INFO - Starting attempt 2 of 2
[2024-09-30T07:44:10.449+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): extract_and_save_company_market_info> on 2024-09-29 00:00:00+00:00
[2024-09-30T07:44:10.456+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=19401) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-09-30T07:44:10.458+0000] {standard_task_runner.py:72} INFO - Started process 19403 to run task
[2024-09-30T07:44:10.459+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'scrape_and_save_share_prices_with_company_data', 'extract_and_save_company_market_info', 'scheduled__2024-09-29T00:00:00+00:00', '--job-id', '4253', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpp65mbey4']
[2024-09-30T07:44:10.460+0000] {standard_task_runner.py:105} INFO - Job 4253: Subtask extract_and_save_company_market_info
[2024-09-30T07:44:10.509+0000] {task_command.py:467} INFO - Running <TaskInstance: scrape_and_save_share_prices_with_company_data.extract_and_save_company_market_info scheduled__2024-09-29T00:00:00+00:00 [running]> on host 7746de5121f6
[2024-09-30T07:44:10.598+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='scrape_and_save_share_prices_with_company_data' AIRFLOW_CTX_TASK_ID='extract_and_save_company_market_info' AIRFLOW_CTX_EXECUTION_DATE='2024-09-29T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-09-29T00:00:00+00:00'
[2024-09-30T07:44:10.599+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-09-30T07:44:10.600+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-09-30T07:44:10.601+0000] {logging_mixin.py:190} INFO - Current task name:extract_and_save_company_market_info state:running start_date:2024-09-30 07:44:10.425507+00:00
[2024-09-30T07:44:10.602+0000] {logging_mixin.py:190} INFO - Dag name:scrape_and_save_share_prices_with_company_data and current dag run status:running
[2024-09-30T07:44:10.602+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-09-30T07:44:10.612+0000] {base.py:84} INFO - Retrieving connection 'dse_connection'
[2024-09-30T07:44:13.643+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.50', '-']
[2024-09-30T07:44:13.644+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.50', '-', '1:44 PM', '3.40 - 3.50']
[2024-09-30T07:44:13.644+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.50', '-', '1:44 PM', '3.40 - 3.50', '0.1', '0.50']
[2024-09-30T07:44:13.645+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.50', '-', '1:44 PM', '3.40 - 3.50', '0.1', '0.50', '2.94%', '3.30 - 6.10']
[2024-09-30T07:44:13.645+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.50', '-', '1:44 PM', '3.40 - 3.50', '0.1', '0.50', '2.94%', '3.30 - 6.10', '3.40', '147,461.00']
[2024-09-30T07:44:13.646+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.50', '-', '1:44 PM', '3.40 - 3.50', '0.1', '0.50', '2.94%', '3.30 - 6.10', '3.40', '147,461.00', '3.40', '46']
[2024-09-30T07:44:13.646+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.50', '-', '1:44 PM', '3.40 - 3.50', '0.1', '0.50', '2.94%', '3.30 - 6.10', '3.40', '147,461.00', '3.40', '46', '3.40', '985.739']
[2024-09-30T07:44:13.653+0000] {base.py:84} INFO - Retrieving connection 'dse_connection'
[2024-09-30T07:44:13.657+0000] {sql.py:509} INFO - Running statement: 
            INSERT INTO company_market_info (date, last_trading_price, closing_price, last_update, day_range, change,
                                             change_percentage, day_value, weeks_moving_range, opening_price, day_volume,
                                             adjusted_opening_price, day_trade, yesterday_closing_price, market_capitalization, company_id) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);
        , parameters: (datetime.datetime(2024, 9, 30, 7, 44, 13, 647371), '3.50', '-', '1:44 PM', '3.40 - 3.50', '0.1', '0.50', '2.94%', '3.30 - 6.10', '3.40', '147,461.00', '3.40', '46', '3.40', '985.739', 1)
[2024-09-30T07:44:13.660+0000] {sql.py:518} INFO - Rows affected: 1
[2024-09-30T07:44:15.806+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.00', '-']
[2024-09-30T07:44:15.807+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.00', '-', '1:44 PM', '30.20 - 33.00']
[2024-09-30T07:44:15.807+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.00', '-', '1:44 PM', '30.20 - 33.00', '-1', '2.05']
[2024-09-30T07:44:15.808+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.00', '-', '1:44 PM', '30.20 - 33.00', '-1', '2.05', '-3.13%', '14.00 - 51.40']
[2024-09-30T07:44:15.808+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.00', '-', '1:44 PM', '30.20 - 33.00', '-1', '2.05', '-3.13%', '14.00 - 51.40', '33.00', '66,221.00']
[2024-09-30T07:44:15.809+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.00', '-', '1:44 PM', '30.20 - 33.00', '-1', '2.05', '-3.13%', '14.00 - 51.40', '33.00', '66,221.00', '32.00', '103']
[2024-09-30T07:44:15.809+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.00', '-', '1:44 PM', '30.20 - 33.00', '-1', '2.05', '-3.13%', '14.00 - 51.40', '33.00', '66,221.00', '32.00', '103', '32.00', '640.000']
[2024-09-30T07:44:15.816+0000] {base.py:84} INFO - Retrieving connection 'dse_connection'
[2024-09-30T07:44:15.820+0000] {sql.py:509} INFO - Running statement: 
            INSERT INTO company_market_info (date, last_trading_price, closing_price, last_update, day_range, change,
                                             change_percentage, day_value, weeks_moving_range, opening_price, day_volume,
                                             adjusted_opening_price, day_trade, yesterday_closing_price, market_capitalization, company_id) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);
        , parameters: (datetime.datetime(2024, 9, 30, 7, 44, 15, 810330), '31.00', '-', '1:44 PM', '30.20 - 33.00', '-1', '2.05', '-3.13%', '14.00 - 51.40', '33.00', '66,221.00', '32.00', '103', '32.00', '640.000', 2)
[2024-09-30T07:44:15.823+0000] {sql.py:518} INFO - Rows affected: 1
[2024-09-30T07:44:17.746+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.10', '-']
[2024-09-30T07:44:17.747+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.10', '-', '1:44 PM', '31.10 - 32.20']
[2024-09-30T07:44:17.747+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.10', '-', '1:44 PM', '31.10 - 32.20', '-0.7', '7.66']
[2024-09-30T07:44:17.748+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.10', '-', '1:44 PM', '31.10 - 32.20', '-0.7', '7.66', '-2.20%', '29.00 - 59.30']
[2024-09-30T07:44:17.749+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.10', '-', '1:44 PM', '31.10 - 32.20', '-0.7', '7.66', '-2.20%', '29.00 - 59.30', '32.20', '242,416.00']
[2024-09-30T07:44:17.750+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.10', '-', '1:44 PM', '31.10 - 32.20', '-0.7', '7.66', '-2.20%', '29.00 - 59.30', '32.20', '242,416.00', '31.80', '469']
[2024-09-30T07:44:17.750+0000] {logging_mixin.py:190} INFO - [Ellipsis, '31.10', '-', '1:44 PM', '31.10 - 32.20', '-0.7', '7.66', '-2.20%', '29.00 - 59.30', '32.20', '242,416.00', '31.80', '469', '31.80', '2,956.761']
[2024-09-30T07:44:17.758+0000] {base.py:84} INFO - Retrieving connection 'dse_connection'
[2024-09-30T07:44:17.762+0000] {sql.py:509} INFO - Running statement: 
            INSERT INTO company_market_info (date, last_trading_price, closing_price, last_update, day_range, change,
                                             change_percentage, day_value, weeks_moving_range, opening_price, day_volume,
                                             adjusted_opening_price, day_trade, yesterday_closing_price, market_capitalization, company_id) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);
        , parameters: (datetime.datetime(2024, 9, 30, 7, 44, 17, 751543), '31.10', '-', '1:44 PM', '31.10 - 32.20', '-0.7', '7.66', '-2.20%', '29.00 - 59.30', '32.20', '242,416.00', '31.80', '469', '31.80', '2,956.761', 3)
[2024-09-30T07:44:17.765+0000] {sql.py:518} INFO - Rows affected: 1
[2024-09-30T07:44:19.726+0000] {logging_mixin.py:190} INFO - [Ellipsis, '19.70', '-']
[2024-09-30T07:44:19.727+0000] {logging_mixin.py:190} INFO - [Ellipsis, '19.70', '-', '1:44 PM', '19.70 - 20.60']
[2024-09-30T07:44:19.728+0000] {logging_mixin.py:190} INFO - [Ellipsis, '19.70', '-', '1:44 PM', '19.70 - 20.60', '-0.7', '0.95']
[2024-09-30T07:44:19.729+0000] {logging_mixin.py:190} INFO - [Ellipsis, '19.70', '-', '1:44 PM', '19.70 - 20.60', '-0.7', '0.95', '-3.43%', '19.70 - 32.90']
[2024-09-30T07:44:19.729+0000] {logging_mixin.py:190} INFO - [Ellipsis, '19.70', '-', '1:44 PM', '19.70 - 20.60', '-0.7', '0.95', '-3.43%', '19.70 - 32.90', '20.60', '47,600.00']
[2024-09-30T07:44:19.730+0000] {logging_mixin.py:190} INFO - [Ellipsis, '19.70', '-', '1:44 PM', '19.70 - 20.60', '-0.7', '0.95', '-3.43%', '19.70 - 32.90', '20.60', '47,600.00', '20.40', '191']
[2024-09-30T07:44:19.730+0000] {logging_mixin.py:190} INFO - [Ellipsis, '19.70', '-', '1:44 PM', '19.70 - 20.60', '-0.7', '0.95', '-3.43%', '19.70 - 32.90', '20.60', '47,600.00', '20.40', '191', '20.40', '1,320.032']
[2024-09-30T07:44:19.737+0000] {base.py:84} INFO - Retrieving connection 'dse_connection'
[2024-09-30T07:44:19.741+0000] {sql.py:509} INFO - Running statement: 
            INSERT INTO company_market_info (date, last_trading_price, closing_price, last_update, day_range, change,
                                             change_percentage, day_value, weeks_moving_range, opening_price, day_volume,
                                             adjusted_opening_price, day_trade, yesterday_closing_price, market_capitalization, company_id) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);
        , parameters: (datetime.datetime(2024, 9, 30, 7, 44, 19, 731260), '19.70', '-', '1:44 PM', '19.70 - 20.60', '-0.7', '0.95', '-3.43%', '19.70 - 32.90', '20.60', '47,600.00', '20.40', '191', '20.40', '1,320.032', 4)
[2024-09-30T07:44:19.744+0000] {sql.py:518} INFO - Rows affected: 1
[2024-09-30T07:44:24.569+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.60', '-']
[2024-09-30T07:44:24.570+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.60', '-', '1:44 PM', '3.40 - 3.60']
[2024-09-30T07:44:24.570+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.60', '-', '1:44 PM', '3.40 - 3.60', '0.1', '0.43']
[2024-09-30T07:44:24.571+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.60', '-', '1:44 PM', '3.40 - 3.60', '0.1', '0.43', '2.86%', '3.30 - 5.40']
[2024-09-30T07:44:24.572+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.60', '-', '1:44 PM', '3.40 - 3.60', '0.1', '0.43', '2.86%', '3.30 - 5.40', '3.40', '123,353.00']
[2024-09-30T07:44:24.572+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.60', '-', '1:44 PM', '3.40 - 3.60', '0.1', '0.43', '2.86%', '3.30 - 5.40', '3.40', '123,353.00', '3.50', '10']
[2024-09-30T07:44:24.573+0000] {logging_mixin.py:190} INFO - [Ellipsis, '3.60', '-', '1:44 PM', '3.40 - 3.60', '0.1', '0.43', '2.86%', '3.30 - 5.40', '3.40', '123,353.00', '3.50', '10', '3.50', '836.816']
[2024-09-30T07:44:24.581+0000] {base.py:84} INFO - Retrieving connection 'dse_connection'
[2024-09-30T07:44:24.586+0000] {sql.py:509} INFO - Running statement: 
            INSERT INTO company_market_info (date, last_trading_price, closing_price, last_update, day_range, change,
                                             change_percentage, day_value, weeks_moving_range, opening_price, day_volume,
                                             adjusted_opening_price, day_trade, yesterday_closing_price, market_capitalization, company_id) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);
        , parameters: (datetime.datetime(2024, 9, 30, 7, 44, 24, 574282), '3.60', '-', '1:44 PM', '3.40 - 3.60', '0.1', '0.43', '2.86%', '3.30 - 5.40', '3.40', '123,353.00', '3.50', '10', '3.50', '836.816', 5)
[2024-09-30T07:44:24.590+0000] {sql.py:518} INFO - Rows affected: 1
[2024-09-30T07:44:26.696+0000] {logging_mixin.py:190} INFO - [Ellipsis, '9.50', '-']
[2024-09-30T07:44:26.697+0000] {logging_mixin.py:190} INFO - [Ellipsis, '9.50', '-', '1:44 PM', '9.40 - 9.80']
[2024-09-30T07:44:26.698+0000] {logging_mixin.py:190} INFO - [Ellipsis, '9.50', '-', '1:44 PM', '9.40 - 9.80', '-0.2', '24.13']
[2024-09-30T07:44:26.699+0000] {logging_mixin.py:190} INFO - [Ellipsis, '9.50', '-', '1:44 PM', '9.40 - 9.80', '-0.2', '24.13', '-2.06%', '6.50 - 13.80']
[2024-09-30T07:44:26.699+0000] {logging_mixin.py:190} INFO - [Ellipsis, '9.50', '-', '1:44 PM', '9.40 - 9.80', '-0.2', '24.13', '-2.06%', '6.50 - 13.80', '9.70', '2,528,608.00']
[2024-09-30T07:44:26.700+0000] {logging_mixin.py:190} INFO - [Ellipsis, '9.50', '-', '1:44 PM', '9.40 - 9.80', '-0.2', '24.13', '-2.06%', '6.50 - 13.80', '9.70', '2,528,608.00', '9.70', '658']
[2024-09-30T07:44:26.701+0000] {logging_mixin.py:190} INFO - [Ellipsis, '9.50', '-', '1:44 PM', '9.40 - 9.80', '-0.2', '24.13', '-2.06%', '6.50 - 13.80', '9.70', '2,528,608.00', '9.70', '658', '9.70', '8,688.239']
[2024-09-30T07:44:26.708+0000] {base.py:84} INFO - Retrieving connection 'dse_connection'
[2024-09-30T07:44:26.712+0000] {sql.py:509} INFO - Running statement: 
            INSERT INTO company_market_info (date, last_trading_price, closing_price, last_update, day_range, change,
                                             change_percentage, day_value, weeks_moving_range, opening_price, day_volume,
                                             adjusted_opening_price, day_trade, yesterday_closing_price, market_capitalization, company_id) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);
        , parameters: (datetime.datetime(2024, 9, 30, 7, 44, 26, 701842), '9.50', '-', '1:44 PM', '9.40 - 9.80', '-0.2', '24.13', '-2.06%', '6.50 - 13.80', '9.70', '2,528,608.00', '9.70', '658', '9.70', '8,688.239', 6)
[2024-09-30T07:44:26.715+0000] {sql.py:518} INFO - Rows affected: 1
[2024-09-30T12:15:40.476+0000] {job.py:229} INFO - Heartbeat recovered after 16269.66 seconds
[2024-09-30T12:15:50.834+0000] {local_task_job_runner.py:346} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2024-09-30T12:15:50.846+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-09-30T12:15:50.850+0000] {process_utils.py:132} INFO - Sending 15 to group 19403. PIDs of all processes in the group: [19403]
[2024-09-30T12:15:50.854+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 19403
[2024-09-30T12:15:50.856+0000] {taskinstance.py:3092} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-09-30T12:15:50.995+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-09-30T12:15:51.111+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=19403, status='terminated', exitcode=0, started='07:44:10') (19403) terminated with exit code 0
